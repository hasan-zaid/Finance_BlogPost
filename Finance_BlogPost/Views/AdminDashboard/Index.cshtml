@model Finance_BlogPost.Models.ViewModels.AdminDashboardViewModel
@{
}


<h1 class="my-4">Welcome back, Admin!</h1>
<div class="row mt-5">
    <div class="col-md-2 offset-md-1">
        <div class="card text-center h-100">
            <div class="card-body">
                <h3>Total Blog Posts</h3>
                <p class="display-4">@Model.TotalBlogPosts</p>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card text-center h-100">
            <div class="card-body">
                <h3>Total Tags</h3>
                <p class="display-4">@Model.TotalTags</p>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card text-center h-100">
            <div class="card-body">
                <h3>Total Users</h3>
                <p class="display-4">@Model.TotalUsers</p>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card text-center h-100">
            <div class="card-body">
                <h3>Pending Approvals</h3>
                <p class="display-4">@Model.PendingApprovals</p>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="card text-center h-100">
            <div class="card-body">
                <h3>Rejected Posts</h3>
                <p class="display-4">@Model.RejectedPosts</p>
            </div>
        </div>
    </div>
</div>
<div class="row dashboard-card mt-5">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-body">
                <h2>Recent Blog Posts</h2>
                <ul>
                    @foreach (var post in Model.RecentBlogPosts)
                    {
                        <li>@post.PublishedDate.ToString("yyyy-MM-dd") - @post.Heading by @post.AuthorName</li>
                    }
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h2>Top Tags</h2>
                <ul>
                    @foreach (var tag in Model.TagUsage)
                    {
                        <li>@tag.Name (@tag.UsageCount uses)</li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="charts">
    <div class="chart-container">
        <canvas id="blogPostsChart"></canvas>
    </div>
    <div class="doughnut-container">
        <canvas id="tagsChart"></canvas>
    </div>
</div>



@section Scripts{
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        var ctx1 = document.getElementById('blogPostsChart').getContext('2d');
        var blogPostsChart = new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: ['Total', 'Pending', 'Rejected'],
                datasets: [{
                    label: 'Blog Posts',
                    data: [@Model.TotalBlogPosts, @Model.PendingApprovals, @Model.RejectedPosts],
                    backgroundColor: ['#007bff', '#ffc107', '#dc3545']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: 'Blog Posts Overview'
                },
                maintainAspectRatio: false,
                responsive: true
            }
        });

        var ctx2 = document.getElementById('tagsChart').getContext('2d');
        var tagsChart = new Chart(ctx2, {
            type: 'doughnut',
            data: {
                labels: [@Html.Raw(string.Join(",", Model.TagUsage.Select(tag => $"'{tag.Name}'")))],
                datasets: [{
                    label: 'Tag Usage',
                    data: [@Html.Raw(string.Join(",", Model.TagUsage.Select(tag => tag.UsageCount)))],
                    backgroundColor: ['#007bff', '#28a745', '#ffc107', '#17a2b8', '#dc3545']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: 'Top Tags'
                },
                maintainAspectRatio: false,
                responsive: true
            }
        });
    </script>

}